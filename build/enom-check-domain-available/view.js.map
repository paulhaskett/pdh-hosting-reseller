{"version":3,"file":"enom-check-domain-available/view.js","mappings":"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","sources":["webpack://pdh-hosting-reseller/./src/enom-check-domain-available/view.js"],"sourcesContent":["console.log(\"Domain widget view.js loaded\")\n\nif (typeof window.DomainWidget === 'undefined') {\n\tconsole.error('DomainWidget object not found')\n} else {\n\tconsole.log('DomainWidget config:', window.DomainWidget)\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\tdocument.querySelectorAll('.domain-search-form').forEach(form => {\n\t\tconst resultDiv = form.querySelector('.domain-search-result') || (() => {\n\t\t\tconst div = document.createElement('div')\n\t\t\tdiv.className = 'domain-search-result'\n\t\t\tform.appendChild(div)\n\t\t\treturn div\n\t\t})()\n\n\t\tform.addEventListener('submit', async (e) => {\n\t\t\te.preventDefault()\n\t\t\tconst domainInput = form.querySelector('input[name=\"domain\"]')\n\t\t\tconst tldSelect = form.querySelector('select[name=\"tld\"]')\n\t\t\tconst domain = domainInput.value.trim()\n\t\t\tconst tld = tldSelect.value\n\n\t\t\tif (!domain) return resultDiv.textContent = \"Please enter a valid domain\"\n\n\t\t\tresultDiv.innerHTML = `\n    <div style=\"text-align: center; padding: 20px;\">\n        <div style=\"display: inline-flex; gap: 6px; margin-bottom: 10px;\">\n            <span style=\"width: 8px; height: 8px; background: #007bff; border-radius: 50%; animation: typingBounce 1.4s infinite;\"></span>\n            <span style=\"width: 8px; height: 8px; background: #007bff; border-radius: 50%; animation: typingBounce 1.4s infinite; animation-delay: 0.2s;\"></span>\n            <span style=\"width: 8px; height: 8px; background: #007bff; border-radius: 50%; animation: typingBounce 1.4s infinite; animation-delay: 0.4s;\"></span>\n        </div>\n        <p style=\"margin: 0; font-size: 14px; color: #666;\">Checking availability...</p>\n    </div>\n    <style>\n        @keyframes typingBounce {\n            0%, 60%, 100% { \n                transform: translateY(0);\n                opacity: 0.7;\n            }\n            30% { \n                transform: translateY(-10px);\n                opacity: 1;\n            }\n        }\n    </style>\n`\n\n\n\t\t\ttry {\n\t\t\t\tconst response = await fetch('/wp-json/pdh-enom/v2/check-domain', {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t'X-WP-Nonce': DomainWidget.token\n\t\t\t\t\t},\n\t\t\t\t\tbody: JSON.stringify({ domain, tld })\n\t\t\t\t})\n\n\t\t\t\tconst data = await response.json()\n\t\t\t\tconsole.log('API Response:', data)\n\n\t\t\t\tconst result = data['Domains']\n\t\t\t\tconst available = result.Domain.RRPText !== 'Domain not available'\n\n\n\n\t\t\t\tconsole.log('Domain:', result.Domain.Name)\n\t\t\t\tconsole.log('Available:', available)\n\n\n\t\t\t\tif (available) {\n\t\t\t\t\tconst prices = result.Domain.Prices\n\t\t\t\t\tconst regPrice = parseFloat(prices.Registration)\n\t\t\t\t\tconsole.log('Price per year:', regPrice)\n\t\t\t\t\tresultDiv.textContent = `✅ Domain ${result.Domain.Name} is available! ${DomainWidget.currencySymbol}${regPrice}/year to register!`\n\n\t\t\t\t\t// Check if we're on the product page\n\t\t\t\t\tconst isOnProductPage = document.querySelector('form.cart') !== null\n\n\t\t\t\t\tif (isOnProductPage) {\n\t\t\t\t\t\t// We're on the product page - fill in the form and update price\n\t\t\t\t\t\tconsole.log('On product page - filling form')\n\t\t\t\t\t\tpopulateProductFormOnPage(domain, tld, regPrice)\n\n\t\t\t\t\t\t// Show success message\n\t\t\t\t\t\tresultDiv.innerHTML = `<p style=\"color: green; font-weight: bold;\">✅ ${result.Domain.Name} is available! Price: ${DomainWidget.currencySymbol}${regPrice}/year</p>`\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Not on product page - show button to go there\n\t\t\t\t\t\tconst button = document.createElement('a')\n\t\t\t\t\t\tbutton.textContent = 'Configure Domain Registration'\n\n\t\t\t\t\t\t// Build URL with domain info\n\t\t\t\t\t\tconst productUrl = new URL('/product/register-domain/', window.location.origin)\n\t\t\t\t\t\tproductUrl.searchParams.set('domain_name', domain)\n\t\t\t\t\t\tproductUrl.searchParams.set('domain_tld', tld)\n\t\t\t\t\t\tproductUrl.searchParams.set('price', regPrice.toString())\n\n\t\t\t\t\t\tbutton.href = productUrl.toString()\n\t\t\t\t\t\tbutton.className = 'wp-element-button configure-domain-btn'\n\n\t\t\t\t\t\tconst buttonContainer = document.createElement('div')\n\t\t\t\t\t\tbuttonContainer.appendChild(button)\n\t\t\t\t\t\tresultDiv.appendChild(buttonContainer)\n\n\t\t\t\t\t\tconsole.log('Redirect URL:', productUrl.toString())\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Domain not available - show suggestions\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('Fetching name suggestions for', result.Domain.Name)\n\t\t\t\t\t\tconst namesuggestions = await fetch('/wp-json/pdh-enom/v2/get-name-suggestions', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t\t'X-WP-Nonce': DomainWidget.token\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({ searchterm: result.Domain.Name })\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tconst suggData = await namesuggestions.json()\n\t\t\t\t\t\tconst suggestions = suggData['DomainSuggestions'] || []\n\n\t\t\t\t\t\tresultDiv.textContent = `❌ Domain ${result.Domain.Name} is taken.`\n\n\t\t\t\t\t\tif (suggestions['Domain'] && suggestions['Domain'].length > 0) {\n\t\t\t\t\t\t\tconst suggestionsDiv = document.createElement('div')\n\t\t\t\t\t\t\tsuggestionsDiv.className = 'domain-suggestions'\n\t\t\t\t\t\t\tsuggestionsDiv.innerHTML = '<div class=\"domain-suggestions\"><strong>Suggestions:</strong><ul class=\"domain-name-suggestions\">' +\n\t\t\t\t\t\t\t\tsuggestions['Domain'].map(s => `<li>${s}</li>`).join('') +\n\t\t\t\t\t\t\t\t'</ul></div>'\n\t\t\t\t\t\t\tresultDiv.appendChild(suggestionsDiv)\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tconsole.error('Error fetching name suggestions', err)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Error checking domain:', err)\n\t\t\t\tresultDiv.textContent = 'Error checking domain.'\n\t\t\t}\n\t\t})\n\t})\n})\n\n/**\n * When on product page, fill form and set up price updates\n */\nfunction populateProductFormOnPage(domain, tld, pricePerYear) {\n\tconsole.log('populateProductFormOnPage called:', { domain, tld, pricePerYear })\n\n\t// Fill in the domain_name field\n\tconst domainNameInput = document.getElementById('domain_name')\n\tif (domainNameInput) {\n\t\tdomainNameInput.value = domain + '.' + tld\n\t\tdomainNameInput.setAttribute('readonly', 'readonly')\n\t\tdomainNameInput.style.backgroundColor = '#f5f5f5'\n\t\tconsole.log('Set domain_name to:', domain + '.' + tld)\n\t}\n\n\t// Get the product form\n\tconst productForm = document.querySelector('form.cart')\n\tif (!productForm) {\n\t\tconsole.warn('Product form not found')\n\t\treturn\n\t}\n\n\t// Store price per year globally for calculations\n\twindow.domainPricePerYear = pricePerYear\n\tconsole.log('Stored domainPricePerYear:', window.domainPricePerYear)\n\n\t// Create/update hidden fields\n\tensureHiddenField(productForm, 'domain_name', domain)\n\tensureHiddenField(productForm, 'domain_tld', tld)\n\n\t// Set initial price for 1 year\n\tupdatePriceOnProductPage(1, pricePerYear)\n\n\t// Listen for years dropdown changes\n\tconst yearsSelect = document.getElementById('domain_years')\n\tconsole.log('Years select element:', yearsSelect)\n\n\tif (yearsSelect) {\n\t\t// Remove any existing listeners by cloning\n\t\tconst newYearsSelect = yearsSelect.cloneNode(true)\n\t\tyearsSelect.parentNode.replaceChild(newYearsSelect, yearsSelect)\n\n\t\t// Add new listener\n\t\tnewYearsSelect.addEventListener('change', function () {\n\t\t\tconst years = parseInt(this.value) || 1\n\t\t\tconsole.log('Years changed to:', years)\n\t\t\tupdatePriceOnProductPage(years, pricePerYear)\n\t\t\tensureHiddenField(productForm, 'domain_years', years)\n\t\t})\n\n\n\t\tconsole.log('Change listener attached to years dropdown')\n\t} else {\n\t\tconsole.warn('domain_years dropdown not found')\n\t}\n\n\n}\n\n/**\n * Update price and hidden field when years change\n */\nfunction updatePriceOnProductPage(years, pricePerYear) {\n\tif (!pricePerYear || years < 1) return\n\n\tconst totalPrice = pricePerYear * years\n\tconsole.log('updatePriceOnProductPage:', { years, pricePerYear, totalPrice })\n\n\t// Update hidden field in form\n\tconst productForm = document.querySelector('form.cart')\n\tif (productForm) {\n\t\tensureHiddenField(productForm, 'domain_registration_price', totalPrice.toString())\n\t}\n\n\t// Update displayed price on page\n\tupdateDisplayedPrice(totalPrice, years, pricePerYear)\n}\n\n/**\n * Update the displayed price on the page\n */\nfunction updateDisplayedPrice(totalPrice, years, pricePerYear) {\n\tif (isNaN(totalPrice) || totalPrice <= 0) return\n\n\tconst formatted = totalPrice.toFixed(2)\n\tconst symbol = (window.DomainWidget && window.DomainWidget.currencySymbol)\n\t\t? window.DomainWidget.currencySymbol\n\t\t: '£'\n\n\tconsole.log('updateDisplayedPrice:', { totalPrice: formatted, years, symbol })\n\n\t// Update all price display elements\n\tdocument.querySelectorAll('.woocommerce-Price-amount.amount').forEach(function (el) {\n\t\tlet priceHtml = '<bdi><span class=\"woocommerce-Price-currencySymbol\">' + symbol + '</span>' + formatted + '</bdi>'\n\n\t\tif (years > 1) {\n\t\t\tpriceHtml += ' <small style=\"font-size: 0.8em; color: #666;\">(' + years + ' years @ ' + symbol + pricePerYear.toFixed(2) + '/year)</small>'\n\t\t}\n\n\t\tel.innerHTML = priceHtml\n\t})\n\n\t// Also try to update .price elements\n\tdocument.querySelectorAll('.price').forEach(function (priceEl) {\n\t\tconst priceAmount = priceEl.querySelector('.woocommerce-Price-amount')\n\t\tif (priceAmount) {\n\t\t\tlet priceHtml = '<bdi><span class=\"woocommerce-Price-currencySymbol\">' + symbol + '</span>' + formatted + '</bdi>'\n\t\t\tif (years > 1) {\n\t\t\t\tpriceHtml += ' <small style=\"font-size: 0.8em; color: #666;\">(' + years + ' years @ ' + symbol + pricePerYear.toFixed(2) + '/year)</small>'\n\t\t\t}\n\t\t\tpriceAmount.innerHTML = priceHtml\n\t\t}\n\t})\n}\n\n/**\n * Ensure a hidden input field exists with the correct value\n */\nfunction ensureHiddenField(form, name, value) {\n\tlet field = form.querySelector('input[name=\"' + name + '\"]')\n\n\tif (!field || field.type !== 'hidden') {\n\t\t// Create or find hidden field\n\t\tlet hiddenField = form.querySelector('input[type=\"hidden\"][name=\"' + name + '\"]')\n\t\tif (!hiddenField) {\n\t\t\thiddenField = document.createElement('input')\n\t\t\thiddenField.type = 'hidden'\n\t\t\thiddenField.name = name\n\t\t\tform.appendChild(hiddenField)\n\t\t\tconsole.log('Created hidden field:', name)\n\t\t}\n\t\thiddenField.value = value\n\t} else {\n\t\t// Update existing field\n\t\tfield.value = value\n\t}\n\n\tconsole.log('Set ' + name + ' = ' + value)\n}"],"names":["console","log","window","DomainWidget","error","document","addEventListener","querySelectorAll","forEach","form","resultDiv","querySelector","div","createElement","className","appendChild","e","preventDefault","domainInput","tldSelect","domain","value","trim","tld","textContent","innerHTML","response","fetch","method","headers","token","body","JSON","stringify","data","json","result","available","Domain","RRPText","Name","prices","Prices","regPrice","parseFloat","Registration","currencySymbol","isOnProductPage","populateProductFormOnPage","button","productUrl","URL","location","origin","searchParams","set","toString","href","buttonContainer","namesuggestions","searchterm","suggData","suggestions","length","suggestionsDiv","map","s","join","err","pricePerYear","domainNameInput","getElementById","setAttribute","style","backgroundColor","productForm","warn","domainPricePerYear","ensureHiddenField","updatePriceOnProductPage","yearsSelect","newYearsSelect","cloneNode","parentNode","replaceChild","years","parseInt","totalPrice","updateDisplayedPrice","isNaN","formatted","toFixed","symbol","el","priceHtml","priceEl","priceAmount","name","field","type","hiddenField"],"sourceRoot":""}