{"version":3,"file":"enom-check-domain-available/view.js","mappings":"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","sources":["webpack://pdh-hosting-reseller/./src/enom-check-domain-available/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\nconsole.log(\"this ran \")\nif (typeof DomainWidget === 'undefined') {\n\tconsole.error('DomainWidget object not found')\n\n}\nconsole.log(DomainWidget.token)\nconsole.log(DomainWidget.restUrl)\nconsole.log(DomainWidget.name)\n\n/* eslint-disable no-console */\ndocument.addEventListener('DOMContentLoaded', () => {\n\tdocument.querySelectorAll('.domain-search-form').forEach(form => {\n\t\tconst resultDiv = form.querySelector('.domain-search-result') || (() => {\n\t\t\tconst div = document.createElement('div')\n\t\t\tdiv.className = 'domain-search-result'\n\t\t\tform.appendChild(div)\n\t\t\treturn div\n\t\t})()\n\n\t\tform.addEventListener('submit', async (e) => {\n\t\t\te.preventDefault()\n\t\t\tconst domainInput = form.querySelector('input[name=\"domain\"]')\n\t\t\tconst tldSelect = form.querySelector('select[name=\"tld\"]')\n\t\t\tconst domain = domainInput.value.trim()\n\t\t\tconst tld = tldSelect.value\n\t\t\tconst domain_name = document.getElementById('domain_name')\n\n\t\t\tif (!domain) return resultDiv.textContent = \"Please enter a valid domain\"\n\n\t\t\tresultDiv.textContent = 'Checking…'\n\n\t\t\ttry {\n\t\t\t\tconst response = await fetch('/wp-json/pdh-enom/v2/check-domain', {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t'X-WP-Nonce': DomainWidget.token\n\t\t\t\t\t},\n\t\t\t\t\tbody: JSON.stringify({ domain, tld })\n\t\t\t\t})\n\t\t\t\tconst data = await response.json()\n\t\t\t\tconst result = data['Domains']\n\t\t\t\tconsole.log('result', result)\n\t\t\t\tif (result.Domain.RRPText === 'Domain not available') {\n\t\t\t\t\tavailable = false\n\t\t\t\t} else {\n\t\t\t\t\tavailable = true\n\t\t\t\t}\n\t\t\t\tconsole.log('RRPText', result.Domain.RRPText)\n\t\t\t\tconsole.log(available)\n\t\t\t\tconst prices = result.Domain.Prices\n\n\t\t\t\tif (available) {\n\t\t\t\t\tresultDiv.textContent = `✅ Domain ${result.Domain.Name} is available! £${prices.Registration} to register!`\n\t\t\t\t\t//check if the product domain name field exists if not ask if user wants to register domain and forward them to the domain single product page\n\n\n\n\t\t\t\t\tif (domain_name) {\n\t\t\t\t\t\t// add the domain name to product field\n\n\t\t\t\t\t\tdomain_name.value = result.Domain.Name\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst button = document.createElement('a')\n\t\t\t\t\t\tbutton.textContent = 'Configure Domain Registration'\n\t\t\t\t\t\tbutton.href = '/product/register-domain/?domain_name=' + encodeURIComponent(result.Domain.Name) + '&prices' + encodeURIComponent(result.Domain.Prices.Registration)\n\t\t\t\t\t\tbutton.className = 'wp-element-button configure-domain-btn'\n\t\t\t\t\t\tconst buttonContainer = document.createElement('div')\n\t\t\t\t\t\tbuttonContainer.appendChild(button)\n\t\t\t\t\t\tresultDiv.appendChild(buttonContainer)\n\t\t\t\t\t}\n\n\n\n\t\t\t\t} else {\n\t\t\t\t\tresultDiv.textContent = `❌ Domain ${result.Domain.Name} is taken.`\n\t\t\t\t\tif (domain_name) {\n\t\t\t\t\t\tdomain_name.value = ''\n\t\t\t\t\t}\n\n\t\t\t\t\t//const domainQuery = encodeURIComponent(result.Domain.Name)\n\t\t\t\t\t// get suggested names\n\t\t\t\t\t// get suggested names\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('Fetching name suggestions for', result.Domain.Name)\n\t\t\t\t\t\tconst namesuggestions = await fetch('/wp-json/pdh-enom/v2/get-name-suggestions', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t\t\t\t\t'X-WP-Nonce': DomainWidget.token\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({ searchterm: result.Domain.Name })\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tconst data = await namesuggestions.json()\n\t\t\t\t\t\tconsole.log('data response', data)\n\t\t\t\t\t\tconst suggestions = data['DomainSuggestions'] || []\n\t\t\t\t\t\tconsole.log('suggestions ', suggestions)\n\t\t\t\t\t\tconsole.log('suggestions length', suggestions['Domain'].length)\n\t\t\t\t\t\tconst suggestionsDiv = document.createElement('div')\n\t\t\t\t\t\tsuggestionsDiv.className = 'domain-suggestions'\n\n\t\t\t\t\t\tif (suggestions['Domain'].length > 0) {\n\t\t\t\t\t\t\tsuggestionsDiv.innerHTML = '<strong>Suggestions:</strong><ul>' +\n\t\t\t\t\t\t\t\tsuggestions['Domain'].map(s => `<li>${s}</li>`).join('') +\n\t\t\t\t\t\t\t\t'</ul>'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsuggestionsDiv.textContent = 'No alternative suggestions found.'\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresultDiv.appendChild(suggestionsDiv)\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tconsole.error('Error fetching name suggestions', err)\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\n\n\t\t\t} catch (err) {\n\t\t\t\tresultDiv.textContent = 'Error checking domain.'\n\t\t\t}\n\t\t})\n\t})\n})\n\n\n\n\n/* eslint-enable no-console */\n"],"names":["console","log","DomainWidget","error","token","restUrl","name","document","addEventListener","querySelectorAll","forEach","form","resultDiv","querySelector","div","createElement","className","appendChild","e","preventDefault","domainInput","tldSelect","domain","value","trim","tld","domain_name","getElementById","textContent","response","fetch","method","headers","body","JSON","stringify","data","json","result","Domain","RRPText","available","prices","Prices","Name","Registration","button","href","encodeURIComponent","buttonContainer","namesuggestions","searchterm","suggestions","length","suggestionsDiv","innerHTML","map","s","join","err"],"sourceRoot":""}